--Source Code: Murach's SQL Server 2016 for Developers pg 133 figure 4-4
--SQL Query--This demonstrates how to join data from two tables with two join conditions and an order by clause 

SELECT InvoiceNumber, InvoiceDate,
    InvoiceTotal, InvoiceLineItemAmount
FROM Invoices JOIN InvoiceLineItems AS LineItems
    ON (Invoices.InvoiceID = LineItems.InvoiceID) AND
       (Invoices.InvoiceTotal > LineItems.InvoiceLineItemAmount)
ORDER BY InvoiceNumber;

/*
This query selects the InvoiceNumber, InvoiceDate, InvoiceTotal, and InvoiceLine ItemAmount columns to retrieve data from.
It JOINs data from the Invoices and InvoiceLineItems table using an inner join. With an inner join one may write the INNER keyword
but it is not required.The AS shows a column alias, shortening the name of the second table to 
LineItems and then using that throughout the query. There are them two join conditions. The first is that the invoiceID has to match 
in both tables. The second is that the InvoiceTotal from the Invoices table has to be larger than the InvoiceLineItemAmount from 
the LineItems table. 
*/



/*---------Sample Output
InvoiceNumber	InvoiceDate	InvoiceTotal	InvoiceLineItemAmount
97/522	2016-02-28 00:00:00	1962.13	1197.00
97/522	2016-02-28 00:00:00	1962.13	765.13
I77271-O01	2015-12-26 00:00:00	662.00	50.00
I77271-O01	2015-12-26 00:00:00	662.00	75.60
I77271-O01	2015-12-26 00:00:00	662.00	58.40
I77271-O01	2015-12-26 00:00:00	662.00	478.00
*/

